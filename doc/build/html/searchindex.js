Search.setIndex({"docnames": ["gnnwr/datasets", "gnnwr/models", "gnnwr/networks", "gnnwr/utils", "index"], "filenames": ["gnnwr/datasets.rst", "gnnwr/models.rst", "gnnwr/networks.rst", "gnnwr/utils.rst", "index.rst"], "titles": ["gnnwr.datasets module", "gnnwr.models module", "gnnwr.networks module", "gnnwr.utils module", "Welcome to GNNWR\u2019s documentation!"], "terms": {"basicdist": [0, 4], "x": [0, 2], "y": [0, 1], "sourc": [0, 1, 2, 3], "calcul": [0, 2, 3], "distanc": 0, "between": 0, "two": [0, 2], "point": 0, "paramet": [0, 1, 2, 3], "input": [0, 1, 2, 3], "coordin": 0, "data": [0, 3], "target": 0, "return": [0, 1, 2, 3], "matrix": [0, 3], "manhattan_dist": [0, 4], "manhattan": 0, "class": [0, 1, 2, 3], "basedataset": [0, 1, 4], "none": [0, 1, 2, 3], "x_column": 0, "list": [0, 1, 2, 3], "y_column": [0, 3], "id_column": 0, "is_need_stnn": 0, "fals": [0, 1, 2], "base": [0, 1, 2, 3], "i": [0, 1, 2, 3], "which": [0, 1, 2], "us": [0, 1, 2], "store": 0, "other": [0, 1], "inform": [0, 1], "also": 0, "provid": 0, "function": [0, 1, 2], "scale": [0, 4], "save": [0, 1, 4], "load": [0, 1], "independ": [0, 3], "variabl": [0, 3], "column": [0, 3], "name": [0, 1, 3], "depend": [0, 3], "whether": [0, 1, 2], "stnn": [0, 1, 2], "getscaleddatafram": [0, 4], "get": [0, 1, 3], "datafram": [0, 1], "read": [0, 4], "dirnam": 0, "directori": 0, "rescal": [0, 4], "scale_fn": 0, "scale_param": 0, "minmaxscal": 0, "standardscal": 0, "like": 0, "scale2": [0, 4], "max": [0, 1], "min": [0, 1], "init_dataset": [0, 4], "test_ratio": 0, "valid_ratio": 0, "spatial_column": 0, "temp_column": 0, "sample_se": 0, "100": [0, 1], "process_fn": 0, "minmax_scal": [0, 4], "batch_siz": 0, "32": [0, 1], "shuffl": 0, "true": [0, 1, 2], "use_class": 0, "spatial_fun": 0, "temporal_fun": 0, "max_val_s": 0, "1": [0, 1, 2], "max_test_s": 0, "from_for_cv": 0, "0": [0, 1, 2], "refer": 0, "simple_dist": 0, "initi": [0, 1], "train": [0, 1], "set": 0, "valid": [0, 1], "test": [0, 1, 3], "model": [0, 2, 4], "ratio": 0, "attribut": 0, "output": [0, 1, 2, 3], "spatial": [0, 1, 2], "tempor": [0, 1, 2], "random": 0, "seed": 0, "pre": 0, "process": [0, 1], "batch": [0, 1, 2], "size": [0, 1, 2], "one": [0, 1, 2], "inject": 0, "start": [0, 1], "index": [0, 4], "cross": 0, "simpl": 0, "init_dataset_cv": [0, 4], "k_fold": 0, "k": 0, "fold": 0, "label": 0, "id": 0, "need": [0, 2], "cv_data_set": 0, "test_dataset": [0, 1], "init_predict_dataset": [0, 4], "train_dataset": [0, 1], "scale_sync": 0, "predictdataset": [0, 1, 4], "max_siz": 0, "predict": [0, 1, 4], "sync": 0, "predict_dataset": 0, "load_dataset": [0, 4], "scale_info": 0, "minmax": 0, "scaler": 0, "minimum": [0, 1], "valu": 0, "each": [0, 1, 2], "maximum": [0, 1], "standard_scal": [0, 4], "mean": 0, "std": 0, "standard": 0, "deviat": 0, "valid_dataset": 1, "dense_lay": [1, 2], "start_lr": 1, "float": [1, 2], "optim": 1, "adagrad": 1, "drop_out": [1, 2], "2": [1, 2], "batch_norm": [1, 2], "activate_func": [1, 2], "prelu": [1, 2], "num_paramet": [1, 2], "model_nam": 1, "gnnwr_20231128": 1, "111456": 1, "model_save_path": 1, "gnnwr_model": 1, "write_path": 1, "gnnwr_run": 1, "20231128": 1, "use_gpu": 1, "bool": [1, 2], "use_ol": 1, "log_path": 1, "gnnwr_log": 1, "log_file_nam": 1, "gnnwr20231128": 1, "log": 1, "log_level": 1, "20": [1, 3], "optimizer_param": 1, "object": [1, 3], "geograph": 1, "neural": [1, 2, 3], "network": [1, 3, 4], "weight": [1, 2, 3], "regress": 1, "address": 1, "non": 1, "stationar": 1, "variou": 1, "domain": 1, "complex": 1, "come": 1, "from": 1, "paper": 1, "accur": 1, "estim": 1, "dataset": [1, 3, 4], "dens": [1, 2], "layer": [1, 2], "default": [1, 2], "structur": 1, "geometr": 1, "sequenc": 1, "power": 1, "closest": 1, "number": 1, "neuron": 1, "e": 1, "4": [1, 3], "8": 1, "16": 1, "64": 1, "128": 1, "256": 1, "learn": 1, "rate": [1, 2], "str": 1, "option": 1, "choos": 1, "sgd": 1, "adam": 1, "rmsprop": 1, "adadelta": 1, "drop": [1, 2], "out": [1, 2], "normal": [1, 2], "torch": [1, 2], "nn": [1, 2], "activ": [1, 2], "init": [1, 2], "gnnwr_": 1, "datetim": 1, "todai": 1, "strftime": 1, "m": 1, "d": 1, "h": 1, "": [1, 3], "path": 1, "now": 1, "gpu": 1, "ol": [1, 3, 4], "int": [1, 2], "level": 1, "info": 1, "dict": 1, "param": [1, 3], "schedul": 1, "ar": 1, "maxlr": 1, "minlr": 1, "01": 1, "upepoch": 1, "epoch": 1, "up": 1, "10000": 1, "decayepoch": 1, "decai": 1, "20000": 1, "decayr": 1, "stop_change_epoch": 1, "stop": 1, "chang": 1, "30000": 1, "stop_lr": 1, "when": 1, "001": 1, "cosineannealingwarmrestart": 1, "multisteplr": 1, "cosineannealinglr": 1, "scheduler_mileston": 1, "mileston": 1, "500": 1, "1000": 1, "2000": 1, "4000": 1, "scheduler_gamma": 1, "gamma": 1, "5": 1, "scheduler_t_max": 1, "t_max": 1, "scheduler_eta_min": 1, "eta_min": 1, "scheduler_t_0": 1, "t_0": 1, "scheduler_t_mult": 1, "t_mult": 1, "3": 1, "add_graph": [1, 4], "add": 1, "graph": 1, "tensorboard": 1, "getloss": [1, 4], "loss": 1, "type": [1, 2], "getweight": [1, 4], "argument": 1, "panda": 1, "gpumodel_to_cpu": [1, 4], "save_path": 1, "use_model": 1, "convert": 1, "cpu": 1, "new": 1, "init_optim": [1, 4], "load_model": [1, 4], "use_dict": 1, "map_loc": 1, "locat": 1, "can": 1, "cuda": 1, "result": [1, 3, 4], "predict_weight": [1, 4], "reg_result": [1, 4], "filenam": 1, "model_path": 1, "only_return": 1, "includ": 1, "bia": 1, "file": 1, "self": 1, "_modelsavepath": 1, "_modelnam": 1, "pkl": 1, "onli": 1, "print": 1, "run": [1, 2, 4], "max_epoch": 1, "early_stop": 1, "print_frequ": 1, "50": 1, "show_detailed_info": 1, "ha": 1, "been": 1, "updat": 1, "until": 1, "frequenc": 1, "gtnnwr": [1, 3, 4], "gtnnwr_20231128": 1, "gtnnwr_model": 1, "gtnnwr_run": 1, "gtnnwr_log": 1, "gtnnwr20231128": 1, "stpnn_outsiz": 1, "stnn_spnn_param": 1, "stpnn": [1, 2, 4], "solv": 1, "problem": 1, "first": 1, "hidden": 1, "second": 1, "swnn": [1, 2, 4], "spnn": [1, 2], "stpnn_batch_norm": 1, "batchnorm": 1, "stnn_spnn": [2, 4], "stnn_insiz": 2, "stnn_outsiz": 2, "spnn_insiz": 2, "spnn_outsiz": 2, "relu": 2, "proxim": 2, "node": 2, "same": 2, "time": 2, "The": 2, "follow": 2, "full": 2, "connect": 2, "must": 2, "posit": 2, "forward": [2, 4], "input1": 2, "defin": 2, "comput": 2, "perform": 2, "everi": 2, "call": 2, "should": 2, "overridden": 2, "all": [2, 3], "subclass": 2, "although": 2, "recip": 2, "pass": 2, "within": 2, "thi": 2, "instanc": 2, "afterward": 2, "instead": 2, "sinc": 2, "former": 2, "take": 2, "care": 2, "regist": 2, "hook": 2, "while": 2, "latter": 2, "silent": 2, "ignor": 2, "them": 2, "insiz": 2, "outsiz": 2, "featur": 2, "default_dense_lay": [2, 4], "gener": 2, "weight_shar": [2, 4], "output_s": 2, "share": 2, "tensor": 2, "diagnosi": [3, 4], "x_data": 3, "y_data": 3, "y_pred": 3, "diagnos": 3, "aic": [3, 4], "aicc": [3, 4], "adjust_r2": [3, 4], "adjust": 3, "r2": [3, 4], "f1_gnn": [3, 4], "f1": 3, "rmse": [3, 4], "hat": [3, 4], "xname": 3, "yname": 3, "olr": 3, "visual": [3, 4], "lon_lat_column": 3, "zoom": 3, "display_dataset": [3, 4], "color": 3, "step": 3, "vmin": 3, "vmax": 3, "dot_map": [3, 4], "lon_column": 3, "lat_column": 3, "weights_heatmap": [3, 4], "data_column": 3, "modul": 4, "util": 4, "search": 4, "page": 4}, "objects": {"gnnwr": [[0, 0, 0, "-", "datasets"], [1, 0, 0, "-", "models"], [2, 0, 0, "-", "networks"], [3, 0, 0, "-", "utils"]], "gnnwr.datasets": [[0, 1, 1, "", "BasicDistance"], [0, 1, 1, "", "Manhattan_distance"], [0, 2, 1, "", "baseDataset"], [0, 1, 1, "", "init_dataset"], [0, 1, 1, "", "init_dataset_cv"], [0, 1, 1, "", "init_predict_dataset"], [0, 1, 1, "", "load_dataset"], [0, 2, 1, "", "predictDataset"]], "gnnwr.datasets.baseDataset": [[0, 3, 1, "", "getScaledDataframe"], [0, 3, 1, "", "read"], [0, 3, 1, "", "rescale"], [0, 3, 1, "", "save"], [0, 3, 1, "", "scale"], [0, 3, 1, "", "scale2"]], "gnnwr.datasets.predictDataset": [[0, 3, 1, "", "minmax_scaler"], [0, 3, 1, "", "rescale"], [0, 3, 1, "", "standard_scaler"]], "gnnwr.models": [[1, 2, 1, "", "GNNWR"], [1, 2, 1, "", "GTNNWR"]], "gnnwr.models.GNNWR": [[1, 3, 1, "", "add_graph"], [1, 3, 1, "", "getLoss"], [1, 3, 1, "", "getWeights"], [1, 3, 1, "", "gpumodel_to_cpu"], [1, 3, 1, "", "init_optimizer"], [1, 3, 1, "", "load_model"], [1, 3, 1, "", "predict"], [1, 3, 1, "", "predict_weight"], [1, 3, 1, "", "reg_result"], [1, 3, 1, "", "result"], [1, 3, 1, "", "run"]], "gnnwr.networks": [[2, 2, 1, "", "STNN_SPNN"], [2, 2, 1, "", "STPNN"], [2, 2, 1, "", "SWNN"], [2, 1, 1, "", "default_dense_layer"], [2, 1, 1, "", "weight_share"]], "gnnwr.networks.STNN_SPNN": [[2, 3, 1, "", "forward"]], "gnnwr.networks.STPNN": [[2, 3, 1, "", "forward"]], "gnnwr.networks.SWNN": [[2, 3, 1, "", "forward"]], "gnnwr.utils": [[3, 2, 1, "", "DIAGNOSIS"], [3, 2, 1, "", "OLS"], [3, 2, 1, "", "Visualize"]], "gnnwr.utils.DIAGNOSIS": [[3, 3, 1, "", "AIC"], [3, 3, 1, "", "AICc"], [3, 3, 1, "", "Adjust_R2"], [3, 3, 1, "", "F1_GNN"], [3, 3, 1, "", "R2"], [3, 3, 1, "", "RMSE"], [3, 3, 1, "", "hat"]], "gnnwr.utils.Visualize": [[3, 3, 1, "", "display_dataset"], [3, 3, 1, "", "dot_map"], [3, 3, 1, "", "weights_heatmap"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:method"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"]}, "titleterms": {"gnnwr": [0, 1, 2, 3, 4], "dataset": 0, "modul": [0, 1, 2, 3], "model": 1, "network": 2, "util": 3, "welcom": 4, "": 4, "document": 4, "content": 4, "indic": 4, "tabl": 4}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 60}, "alltitles": {"gnnwr.datasets module": [[0, "module-gnnwr.datasets"]], "gnnwr.models module": [[1, "module-gnnwr.models"]], "gnnwr.networks module": [[2, "module-gnnwr.networks"]], "gnnwr.utils module": [[3, "module-gnnwr.utils"]], "Welcome to GNNWR\u2019s documentation!": [[4, "welcome-to-gnnwr-s-documentation"]], "Contents:": [[4, null]], "Indices and tables": [[4, "indices-and-tables"]]}, "indexentries": {"basicdistance() (in module gnnwr.datasets)": [[0, "gnnwr.datasets.BasicDistance"]], "manhattan_distance() (in module gnnwr.datasets)": [[0, "gnnwr.datasets.Manhattan_distance"]], "basedataset (class in gnnwr.datasets)": [[0, "gnnwr.datasets.baseDataset"]], "getscaleddataframe() (gnnwr.datasets.basedataset method)": [[0, "gnnwr.datasets.baseDataset.getScaledDataframe"]], "gnnwr.datasets": [[0, "module-gnnwr.datasets"]], "init_dataset() (in module gnnwr.datasets)": [[0, "gnnwr.datasets.init_dataset"]], "init_dataset_cv() (in module gnnwr.datasets)": [[0, "gnnwr.datasets.init_dataset_cv"]], "init_predict_dataset() (in module gnnwr.datasets)": [[0, "gnnwr.datasets.init_predict_dataset"]], "load_dataset() (in module gnnwr.datasets)": [[0, "gnnwr.datasets.load_dataset"]], "minmax_scaler() (gnnwr.datasets.predictdataset method)": [[0, "gnnwr.datasets.predictDataset.minmax_scaler"]], "module": [[0, "module-gnnwr.datasets"], [1, "module-gnnwr.models"], [2, "module-gnnwr.networks"], [3, "module-gnnwr.utils"]], "predictdataset (class in gnnwr.datasets)": [[0, "gnnwr.datasets.predictDataset"]], "read() (gnnwr.datasets.basedataset method)": [[0, "gnnwr.datasets.baseDataset.read"]], "rescale() (gnnwr.datasets.basedataset method)": [[0, "gnnwr.datasets.baseDataset.rescale"]], "rescale() (gnnwr.datasets.predictdataset method)": [[0, "gnnwr.datasets.predictDataset.rescale"]], "save() (gnnwr.datasets.basedataset method)": [[0, "gnnwr.datasets.baseDataset.save"]], "scale() (gnnwr.datasets.basedataset method)": [[0, "gnnwr.datasets.baseDataset.scale"]], "scale2() (gnnwr.datasets.basedataset method)": [[0, "gnnwr.datasets.baseDataset.scale2"]], "standard_scaler() (gnnwr.datasets.predictdataset method)": [[0, "gnnwr.datasets.predictDataset.standard_scaler"]], "gnnwr (class in gnnwr.models)": [[1, "gnnwr.models.GNNWR"]], "gtnnwr (class in gnnwr.models)": [[1, "gnnwr.models.GTNNWR"]], "add_graph() (gnnwr.models.gnnwr method)": [[1, "gnnwr.models.GNNWR.add_graph"]], "getloss() (gnnwr.models.gnnwr method)": [[1, "gnnwr.models.GNNWR.getLoss"]], "getweights() (gnnwr.models.gnnwr method)": [[1, "gnnwr.models.GNNWR.getWeights"]], "gnnwr.models": [[1, "module-gnnwr.models"]], "gpumodel_to_cpu() (gnnwr.models.gnnwr method)": [[1, "gnnwr.models.GNNWR.gpumodel_to_cpu"]], "init_optimizer() (gnnwr.models.gnnwr method)": [[1, "gnnwr.models.GNNWR.init_optimizer"]], "load_model() (gnnwr.models.gnnwr method)": [[1, "gnnwr.models.GNNWR.load_model"]], "predict() (gnnwr.models.gnnwr method)": [[1, "gnnwr.models.GNNWR.predict"]], "predict_weight() (gnnwr.models.gnnwr method)": [[1, "gnnwr.models.GNNWR.predict_weight"]], "reg_result() (gnnwr.models.gnnwr method)": [[1, "gnnwr.models.GNNWR.reg_result"]], "result() (gnnwr.models.gnnwr method)": [[1, "gnnwr.models.GNNWR.result"]], "run() (gnnwr.models.gnnwr method)": [[1, "gnnwr.models.GNNWR.run"]], "stnn_spnn (class in gnnwr.networks)": [[2, "gnnwr.networks.STNN_SPNN"]], "stpnn (class in gnnwr.networks)": [[2, "gnnwr.networks.STPNN"]], "swnn (class in gnnwr.networks)": [[2, "gnnwr.networks.SWNN"]], "default_dense_layer() (in module gnnwr.networks)": [[2, "gnnwr.networks.default_dense_layer"]], "forward() (gnnwr.networks.stnn_spnn method)": [[2, "gnnwr.networks.STNN_SPNN.forward"]], "forward() (gnnwr.networks.stpnn method)": [[2, "gnnwr.networks.STPNN.forward"]], "forward() (gnnwr.networks.swnn method)": [[2, "gnnwr.networks.SWNN.forward"]], "gnnwr.networks": [[2, "module-gnnwr.networks"]], "weight_share() (in module gnnwr.networks)": [[2, "gnnwr.networks.weight_share"]], "aic() (gnnwr.utils.diagnosis method)": [[3, "gnnwr.utils.DIAGNOSIS.AIC"]], "aicc() (gnnwr.utils.diagnosis method)": [[3, "gnnwr.utils.DIAGNOSIS.AICc"]], "adjust_r2() (gnnwr.utils.diagnosis method)": [[3, "gnnwr.utils.DIAGNOSIS.Adjust_R2"]], "diagnosis (class in gnnwr.utils)": [[3, "gnnwr.utils.DIAGNOSIS"]], "f1_gnn() (gnnwr.utils.diagnosis method)": [[3, "gnnwr.utils.DIAGNOSIS.F1_GNN"]], "ols (class in gnnwr.utils)": [[3, "gnnwr.utils.OLS"]], "r2() (gnnwr.utils.diagnosis method)": [[3, "gnnwr.utils.DIAGNOSIS.R2"]], "rmse() (gnnwr.utils.diagnosis method)": [[3, "gnnwr.utils.DIAGNOSIS.RMSE"]], "visualize (class in gnnwr.utils)": [[3, "gnnwr.utils.Visualize"]], "display_dataset() (gnnwr.utils.visualize method)": [[3, "gnnwr.utils.Visualize.display_dataset"]], "dot_map() (gnnwr.utils.visualize method)": [[3, "gnnwr.utils.Visualize.dot_map"]], "gnnwr.utils": [[3, "module-gnnwr.utils"]], "hat() (gnnwr.utils.diagnosis method)": [[3, "gnnwr.utils.DIAGNOSIS.hat"]], "weights_heatmap() (gnnwr.utils.visualize method)": [[3, "gnnwr.utils.Visualize.weights_heatmap"]]}})